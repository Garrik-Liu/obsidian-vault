æ¯ä¸ªç»„ä»¶éƒ½åŒ…å« â€œç”Ÿå‘½å‘¨æœŸæ–¹æ³•â€ï¼Œä½ å¯ä»¥é‡å†™è¿™äº›æ–¹æ³•ï¼Œä»¥ä¾¿äºåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ç‰¹å®šçš„é˜¶æ®µæ‰§è¡Œè¿™äº›æ–¹æ³•ã€‚
æ ¹æ® [[ç»„ä»¶åˆ›å»º & æŒ‚è½½#åˆ›å»ºæ–¹å¼|åˆ›å»ºæ–¹å¼]] çš„æ–¹å¼ä¸åŒï¼Œç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸä¹Ÿä¸ç›¸åŒã€‚

# Class ç»„ä»¶
[React.Component â€“ React](https://zh-hans.reactjs.org/docs/react-component.html) 
é€šè¿‡ç»§æ‰¿Â `React.Component` åˆ›å»ºçš„ç»„ä»¶ã€‚ç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹ï¼š

<iframe src="https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/" allow="fullscreen" allowfullscreen="" style="height:100%;width:100%; aspect-ratio: 16 / 9; "></iframe>

## æŒ‚è½½
å½“ç»„ä»¶å®ä¾‹è¢«åˆ›å»ºå¹¶æ’å…¥ DOM ä¸­æ—¶ï¼Œå…¶ç”Ÿå‘½å‘¨æœŸè°ƒç”¨é¡ºåºå¦‚ä¸‹ï¼š.
1. [**constructor()**](https://zh-hans.reactjs.org/docs/react-component.html#constructor)
2. [static getDerivedStateFromProps()](https://zh-hans.reactjs.org/docs/react-component.html#static-getderivedstatefromprops)
3. [**render()**](https://zh-hans.reactjs.org/docs/react-component.html#render)
4. [**componentDidMount()**](https://zh-hans.reactjs.org/docs/react-component.html#componentdidmount)

### constructor()

åœ¨ React ç»„ä»¶æŒ‚è½½ä¹‹å‰ï¼Œä¼šè°ƒç”¨å®ƒçš„æ„é€ å‡½æ•°ã€‚
åº”åœ¨å…¶ä»–è¯­å¥ä¹‹å‰è°ƒç”¨Â `super(props)`ã€‚å¦åˆ™ï¼Œ`this.props`Â åœ¨æ„é€ å‡½æ•°ä¸­å¯èƒ½ä¼šå‡ºç°æœªå®šä¹‰çš„ bugã€‚

é€šå¸¸ï¼Œåœ¨ React ä¸­ï¼Œæ„é€ å‡½æ•°ä»…ç”¨äºä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š
-   é€šè¿‡ç»™Â `this.state`Â èµ‹å€¼å¯¹è±¡æ¥åˆå§‹åŒ–[å†…éƒ¨ state](https://zh-hans.reactjs.org/docs/state-and-lifecycle.html)ã€‚
-   ä¸º[äº‹ä»¶å¤„ç†å‡½æ•°](https://zh-hans.reactjs.org/docs/handling-events.html)ç»‘å®šå®ä¾‹

è¦é¿å…åœ¨æ„é€ å‡½æ•°ä¸­å¼•å…¥ä»»ä½•å‰¯ä½œç”¨æˆ–è®¢é˜…ã€‚å¦‚é‡åˆ°æ­¤åœºæ™¯ï¼Œè¯·å°†å¯¹åº”çš„æ“ä½œæ”¾ç½®åœ¨Â `componentDidMount`Â ä¸­

### render()
`render()`Â æ–¹æ³•æ˜¯ class ç»„ä»¶ä¸­å”¯ä¸€å¿…é¡»å®ç°çš„æ–¹æ³•ã€‚

å½“Â `render`Â è¢«è°ƒç”¨æ—¶ï¼Œå®ƒä¼šæ£€æŸ¥Â `this.props`Â å’ŒÂ `this.state`Â çš„å˜åŒ–å¹¶è¿”å›ä»¥ä¸‹ç±»å‹ä¹‹ä¸€ï¼š
-   **React å…ƒç´ **ã€‚é€šå¸¸é€šè¿‡ JSX åˆ›å»ºã€‚ä¾‹å¦‚ï¼Œ`<div />`Â ä¼šè¢« React æ¸²æŸ“ä¸º DOM èŠ‚ç‚¹ï¼Œ`<MyComponent />`Â ä¼šè¢« React æ¸²æŸ“ä¸ºè‡ªå®šä¹‰ç»„ä»¶ï¼Œæ— è®ºæ˜¯Â `<div />`Â è¿˜æ˜¯Â `<MyComponent />`Â å‡ä¸º React å…ƒç´ ã€‚
-   **æ•°ç»„æˆ– fragments**ã€‚ ä½¿å¾— render æ–¹æ³•å¯ä»¥è¿”å›å¤šä¸ªå…ƒç´ ã€‚æ¬²äº†è§£æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…Â [fragments](https://zh-hans.reactjs.org/docs/fragments.html)Â æ–‡æ¡£ã€‚
-   **Portals**ã€‚å¯ä»¥æ¸²æŸ“å­èŠ‚ç‚¹åˆ°ä¸åŒçš„ DOM å­æ ‘ä¸­ã€‚æ¬²äº†è§£æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…æœ‰å…³Â [portals](https://zh-hans.reactjs.org/docs/portals.html)Â çš„æ–‡æ¡£
-   **å­—ç¬¦ä¸²æˆ–æ•°å€¼ç±»å‹**ã€‚å®ƒä»¬åœ¨ DOM ä¸­ä¼šè¢«æ¸²æŸ“ä¸ºæ–‡æœ¬èŠ‚ç‚¹
-   **å¸ƒå°”ç±»å‹æˆ–Â `null`**ã€‚ä»€ä¹ˆéƒ½ä¸æ¸²æŸ“ã€‚ï¼ˆä¸»è¦ç”¨äºæ”¯æŒè¿”å›Â `test && <Child />`Â çš„æ¨¡å¼ï¼Œå…¶ä¸­ test ä¸ºå¸ƒå°”ç±»å‹ã€‚)

`render()`Â å‡½æ•°åº”è¯¥ä¸ºçº¯å‡½æ•°ï¼Œè¿™æ„å‘³ç€åœ¨ä¸ä¿®æ”¹ç»„ä»¶ state çš„æƒ…å†µä¸‹ï¼Œæ¯æ¬¡è°ƒç”¨æ—¶éƒ½è¿”å›ç›¸åŒçš„ç»“æœï¼Œå¹¶ä¸”å®ƒä¸ä¼šç›´æ¥ä¸æµè§ˆå™¨äº¤äº’ã€‚
å¦‚éœ€ä¸æµè§ˆå™¨è¿›è¡Œäº¤äº’ï¼Œè¯·åœ¨Â `componentDidMount()`Â æˆ–å…¶ä»–ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­æ‰§è¡Œä½ çš„æ“ä½œã€‚ä¿æŒÂ `render()`Â ä¸ºçº¯å‡½æ•°ï¼Œå¯ä»¥ä½¿ç»„ä»¶æ›´å®¹æ˜“æ€è€ƒã€‚

### componentDidMount()

`componentDidMount()`Â ä¼šåœ¨ç»„ä»¶æŒ‚è½½åï¼ˆæ’å…¥ DOM æ ‘ä¸­ï¼‰ç«‹å³è°ƒç”¨ã€‚
ä¾èµ–äº DOM èŠ‚ç‚¹çš„åˆå§‹åŒ–åº”è¯¥æ”¾åœ¨è¿™é‡Œã€‚å¦‚éœ€é€šè¿‡ç½‘ç»œè¯·æ±‚è·å–æ•°æ®ï¼Œæ­¤å¤„æ˜¯å®ä¾‹åŒ–è¯·æ±‚çš„å¥½åœ°æ–¹ã€‚

è¿™ä¸ªæ–¹æ³•æ˜¯æ¯”è¾ƒé€‚åˆæ·»åŠ è®¢é˜…çš„åœ°æ–¹ã€‚å¦‚æœæ·»åŠ äº†è®¢é˜…ï¼Œè¯·ä¸è¦å¿˜è®°åœ¨Â `componentWillUnmount()`Â é‡Œå–æ¶ˆè®¢é˜…ã€‚

ä½ å¯ä»¥åœ¨Â `componentDidMount()`Â é‡Œ**ç›´æ¥è°ƒç”¨Â `setState()`**ã€‚
å®ƒå°†è§¦å‘é¢å¤–æ¸²æŸ“ï¼Œä½†æ­¤æ¸²æŸ“ä¼šå‘ç”Ÿåœ¨æµè§ˆå™¨æ›´æ–°å±å¹•ä¹‹å‰ã€‚å¦‚æ­¤ä¿è¯äº†å³ä½¿åœ¨Â `render()`Â ä¸¤æ¬¡è°ƒç”¨çš„æƒ…å†µä¸‹ï¼Œç”¨æˆ·ä¹Ÿä¸ä¼šçœ‹åˆ°ä¸­é—´çŠ¶æ€ã€‚
è¯·è°¨æ…ä½¿ç”¨è¯¥æ¨¡å¼ï¼Œå› ä¸ºå®ƒä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚é€šå¸¸ï¼Œä½ åº”è¯¥åœ¨Â `constructor()`Â ä¸­åˆå§‹åŒ– stateã€‚

## æ›´æ–°
å½“ç»„ä»¶çš„ props æˆ– state å‘ç”Ÿå˜åŒ–æ—¶ä¼šè§¦å‘æ›´æ–°ã€‚ç»„ä»¶æ›´æ–°çš„ç”Ÿå‘½å‘¨æœŸè°ƒç”¨é¡ºåºå¦‚ä¸‹ï¼š
1. [static getDerivedStateFromProps()](https://zh-hans.reactjs.org/docs/react-component.html#static-getderivedstatefromprops)
2. [shouldComponentUpdate()](https://zh-hans.reactjs.org/docs/react-component.html#shouldcomponentupdate)
3. [render()](https://zh-hans.reactjs.org/docs/react-component.html#render)
4. [getSnapshotBeforeUpdate()](https://zh-hans.reactjs.org/docs/react-component.html#getsnapshotbeforeupdate)
5. [**componentDidUpdate()**](https://zh-hans.reactjs.org/docs/react-component.html#componentdidupdate)

### componentDidUpdate()

```ts
componentDidUpdate(prevProps, prevState, snapshot)
```

`componentDidUpdate()`Â ä¼šåœ¨æ›´æ–°åä¼šè¢«ç«‹å³è°ƒç”¨ã€‚é¦–æ¬¡æ¸²æŸ“ä¸ä¼šæ‰§è¡Œæ­¤æ–¹æ³•ã€‚

å½“ç»„ä»¶æ›´æ–°åï¼Œå¯ä»¥åœ¨æ­¤å¤„**å¯¹ DOM è¿›è¡Œæ“ä½œ**ã€‚
å¯ä»¥**å¯¹æ›´æ–°å‰åçš„ props è¿›è¡Œæ¯”è¾ƒ**ã€‚
ä½ ä¹Ÿå¯ä»¥åœ¨Â `componentDidUpdate()`Â ä¸­**ç›´æ¥è°ƒç”¨Â `setState()`**ï¼Œä½†è¯·æ³¨æ„**å®ƒå¿…é¡»è¢«åŒ…è£¹åœ¨ä¸€ä¸ªæ¡ä»¶è¯­å¥é‡Œ**ï¼Œå¦åˆ™ä¼šå¯¼è‡´æ­»å¾ªç¯ã€‚

## å¸è½½
å½“ç»„ä»¶ä» DOM ä¸­ç§»é™¤æ—¶ä¼šè°ƒç”¨å¦‚ä¸‹æ–¹æ³•ï¼š
1. [componentWillUnmount()](https://zh-hans.reactjs.org/docs/react-component.html#componentwillunmount)

### componentWillUnmount()

`componentWillUnmount()`Â ä¼šåœ¨ç»„ä»¶å¸è½½åŠé”€æ¯ä¹‹å‰ç›´æ¥è°ƒç”¨ã€‚
åœ¨æ­¤æ–¹æ³•ä¸­æ‰§è¡Œå¿…è¦çš„æ¸…ç†æ“ä½œï¼Œä¾‹å¦‚ï¼Œæ¸…é™¤ timerï¼Œå–æ¶ˆç½‘ç»œè¯·æ±‚æˆ–æ¸…é™¤åœ¨Â `componentDidMount()`Â ä¸­åˆ›å»ºçš„è®¢é˜…ç­‰ã€‚
`componentWillUnmount()`Â ä¸­**ä¸åº”è°ƒç”¨Â `setState()`**ï¼Œå› ä¸ºè¯¥ç»„ä»¶å°†æ°¸è¿œä¸ä¼šé‡æ–°æ¸²æŸ“ã€‚

# Â create-react-classÂ æ¨¡å—
ä½¿ç”¨Â `create-react-class`Â æ¨¡å—åˆ›å»ºçš„ç»„ä»¶ã€‚

ES6 ä¸­çš„ class ä¸Â `createReactClass()`Â æ–¹æ³•ååˆ†ç›¸ä¼¼ï¼Œä¸‹é¢ä»‹ç»ä¸€äº›åŒºåˆ«ï¼š

ä¸åŒäºåœ¨ Class ç»„ä»¶æŒ‚è½½æ—¶è°ƒç”¨ `constructor` æ„é€ å‡½æ•°ã€‚
è¯¥æ–¹å¼åˆ›å»ºçš„ç»„ä»¶ä¼šåœ¨ `render` è¢«è°ƒç”¨å‰ï¼Œå…ˆè°ƒç”¨å¦‚ä¸‹ğŸ‘‡ğŸ» çš„ä¸¤ä¸ªå‡½æ•°ï¼š

`getDefaultProps`ï¼š
- Prop values returned by this function will be used as defaults if they are not deï¬ned when the component is instantiated.

`getInitialState`ï¼š
- deï¬nes the initial state of the React component.

```tsx
var Greeting = createReactClass({
  getDefaultProps() {
    return {
      name: 'Mary'
    };
  },
  getInitialState() {
    return {
      age: 100
    }
  }
  // ...
});
```

# å‡½æ•°å¼ç»„ä»¶
åœ¨ä½¿ç”¨å‡½æ•°ç»„ä»¶çš„æ—¶å€™ï¼Œæ²¡æœ‰åŠæ³•