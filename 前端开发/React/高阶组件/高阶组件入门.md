# ä»€ä¹ˆæ˜¯é«˜é˜¶ç»„ä»¶
é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰higher-order function,  æ˜¯ React ä¸­ç”¨äºå¤ç”¨ç»„ä»¶é€»è¾‘çš„ä¸€ç§é«˜çº§æŠ€å·§ã€‚HOC è‡ªèº«ä¸æ˜¯ React API çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒæ˜¯ä¸€ç§åŸºäº React çš„ç»„åˆç‰¹æ€§è€Œå½¢æˆçš„è®¾è®¡æ¨¡å¼ã€‚

å…·ä½“è€Œè¨€ï¼Œ**é«˜é˜¶ç»„ä»¶æ˜¯å‚æ•°ä¸ºç»„ä»¶ï¼Œè¿”å›å€¼ä¸ºæ–°ç»„ä»¶çš„å‡½æ•°ã€‚**

```tsx
const HoC = Component => EnhancedComponent
```

```tsx
const withClassName = Component => props => (
  <Component {...props} className="my-class" />
)
```

```ad-tip
In the React community, it is very common to have the prefix **with** for HOCs.
```

ç»„ä»¶æ˜¯å°† props è½¬æ¢ä¸º UIï¼Œè€Œé«˜é˜¶ç»„ä»¶æ˜¯å°†ç»„ä»¶è½¬æ¢ä¸ºå¦ä¸€ä¸ªç»„ä»¶ã€‚

HOC ä¸ä¼šä¿®æ”¹ä¼ å…¥çš„ç»„ä»¶ï¼Œä¹Ÿä¸ä¼šä½¿ç”¨ç»§æ‰¿æ¥å¤åˆ¶å…¶è¡Œä¸ºã€‚ç›¸åï¼ŒHOC é€šè¿‡å°†ç»„ä»¶_åŒ…è£…_åœ¨å®¹å™¨ç»„ä»¶ä¸­æ¥_ç»„æˆ_æ–°ç»„ä»¶ã€‚HOC æ˜¯çº¯å‡½æ•°ï¼Œæ²¡æœ‰å‰¯ä½œç”¨ã€‚

HOC ä¸åº”è¯¥ä¿®æ”¹ä¼ å…¥ç»„ä»¶ï¼Œè€Œåº”è¯¥ä½¿ç”¨ç»„åˆçš„æ–¹å¼ï¼Œé€šè¿‡å°†ç»„ä»¶åŒ…è£…åœ¨å®¹å™¨ç»„ä»¶ä¸­å®ç°åŠŸèƒ½ã€‚
why HOCs usually **spread the props** `{...props}` they receive on the component is because they tend to be transparent and only add the new behavior.

ä¸‹é¢ğŸ‘‡ğŸ» æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç¤ºä¾‹ï¼š

```ad-example

<iframe src="https://codesandbox.io/s/vigilant-phoebe-lli8mk" allow="fullscreen" allowfullscreen="" style="height: 100%; width: 100%; aspect-ratio: 16 / 9;"></iframe>


ä»£ç é‡Œå®ç°äº†ä¸€ä¸ª withInnerWidth é«˜é˜¶ç»„ä»¶ï¼Œå®ƒå¯ä»¥ä¼ é€’ç»™è¢«åŒ…è£¹çš„ç»„ä»¶ï¼Œç»„ä»¶å®½åº¦çš„å‚æ•°ã€‚
å¯ä»¥çœ‹åˆ°éšç€å®½åº¦çš„å˜åŒ–ï¼Œä¼ å…¥è¿›å»çš„ innerWidth å‚æ•°çš„å€¼ï¼Œéšä¹‹æ”¹å˜ã€‚

~~~tsx
import { useState, useEffect } from "react";

const withInnerWidth = (Component) => (props) => {
  const [innerWidth, setInnerWidth] = useState(window.innerWidth);

  const handleResize = () => {
    setInnerWidth(window.innerWidth);
  };

  useEffect(() => {
    window.addEventListener("resize", handleResize);

    return () => {
      window.removeEventListener("resize", handleResize);
    };
  }, []);

  return <Component {...props} innerWidth={innerWidth} />;
};

const MyComponent = ({ innerWidth }) => {
  return <div>Inner Width: {innerWidth}</div>;
};

const MyComponentWithInnerWidth = withInnerWidth(MyComponent);

export default function App() {
  return (
    <div className="App">
      <MyComponentWithInnerWidth />
    </div>
  );
}
~~~
```

# ç”¨ React Hook æ”¹å†™
[[React Hook å…¥é—¨]]

```ad-tip
The new React Hooks can easily replace an HOC by creating custom Hooks.
```

è®©æˆ‘ä»¬ç”¨ Hook å»æ”¹å†™ä¸Šé¢çš„ HOC å‡½æ•°

[Hook Rewrite Hoc Example - CodeSandbox](https://codesandbox.io/s/jovial-vaughan-b82ixy)

```tsx
import { useState, useEffect } from "react";

function useInnerWidth() {
  const [innerWidth, setInnerWidth] = useState(window.innerWidth);

  const handleResize = () => {
    setInnerWidth(window.innerWidth);
  };

  useEffect(() => {
    window.addEventListener("resize", handleResize);

    return () => {
      window.removeEventListener("resize", handleResize);
    };
  }, []);

  return innerWidth;
}

const MyComponent = () => {
  const innerWidth = useInnerWidth();
  return <div>Inner Width (Hook): {innerWidth}</div>;
};

export default function App() {
  return (
    <div className="App">
      <MyComponent />
    </div>
  );
}

```

# æ³¨æ„äº‹é¡¹

# å‚è€ƒ
- [é«˜é˜¶ç»„ä»¶ â€“ React](https://zh-hans.reactjs.org/docs/higher-order-components.html)
